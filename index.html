<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Simple Lyrics Presenter</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }

        body {
            background-color: #000;
            color: #fff;
            font-family: 'Arial', sans-serif;
            overflow: hidden;
            height: 100vh;
            display: flex;
            flex-direction: column;
            position: relative;
        }

        /* Menu Styles */
        .menu-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100vh;
            padding: 20px;
            position: relative;
        }

        .menu-title {
            font-size: clamp(1.8rem, 5vw, 3rem);
            margin-bottom: 20px;
            font-weight: 700; /* Changed to bold */
            letter-spacing: 3px;
            opacity: 0.8;
            text-align: center;
        }

        .song-list {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 15px;
            width: 100%;
            max-width: 900px;
            margin-bottom: 20px;
            overflow-y: auto;
            max-height: 60vh;
            padding: 10px;
        }

        .song-button {
            background-color: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: #fff;
            padding: 20px;
            cursor: pointer;
            border-radius: 10px;
            font-size: 1.1rem;
            transition: all 0.3s ease;
            text-align: center;
            backdrop-filter: blur(10px);
            position: relative;
            min-height: 120px;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }

        .song-button:hover {
            background-color: rgba(255, 255, 255, 0.1);
            transform: translateY(-3px);
            box-shadow: 0 10px 20px rgba(255, 255, 255, 0.1);
        }

        .song-button:active {
            transform: translateY(0);
        }

        .song-button .song-name {
            font-size: clamp(1.2rem, 3vw, 1.4rem);
            margin-bottom: 8px;
            font-weight: 700; /* Changed to bold */
        }

        .song-button .song-info {
            font-size: clamp(0.8rem, 2vw, 0.9rem);
            opacity: 0.6;
            font-weight: 600; /* Changed to semi-bold */
        }

        .delete-btn {
            position: absolute;
            top: 8px;
            right: 8px;
            background: rgba(255, 0, 0, 0.3);
            border: 1px solid rgba(255, 0, 0, 0.5);
            color: #fff;
            width: 32px;
            height: 32px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 0;
            transition: opacity 0.3s ease;
            z-index: 2;
            font-weight: 700; /* Changed to bold */
        }

        .song-button:hover .delete-btn {
            opacity: 1;
        }

        .delete-btn:hover {
            background: rgba(255, 0, 0, 0.5);
        }

        .add-song-btn {
            background-color: rgba(0, 255, 0, 0.1);
            border: 2px dashed rgba(0, 255, 0, 0.3);
            color: #fff;
            padding: 20px;
            cursor: pointer;
            border-radius: 10px;
            font-size: 1.1rem;
            transition: all 0.3s ease;
            text-align: center;
            backdrop-filter: blur(10px);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 120px;
            width: 100%;
            max-width: 900px;
            font-weight: 700; /* Changed to bold */
        }

        .add-song-btn:hover {
            background-color: rgba(0, 255, 0, 0.2);
            transform: translateY(-3px);
        }

        .add-song-btn:active {
            transform: translateY(0);
        }

        .add-icon {
            font-size: clamp(1.5rem, 4vw, 2rem);
            margin-bottom: 8px;
            font-weight: 700; /* Changed to bold */
        }

        /* Presentation Styles */
        .presentation-container {
            display: none;
            flex-direction: column;
            height: 100vh;
            position: relative;
        }

        .presentation-container.active {
            display: flex;
        }

        .slide-container {
            flex: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: clamp(20px, 5vw, 60px);
            position: relative;
            overflow: hidden;
        }

        .slide {
            text-align: center;
            max-width: 90%;
            opacity: 0;
            transform: scale(0.95);
            transition: all 0.5s ease;
            position: absolute;
            width: 100%;
            padding: 20px;
        }

        .slide.active {
            opacity: 1;
            transform: scale(1);
        }

        .slide h2 {
            font-size: clamp(1.5rem, 4vw, 2.5rem);
            margin-bottom: clamp(20px, 3vw, 40px);
            font-weight: 700; /* Changed to bold */
            letter-spacing: 2px;
            opacity: 0.9;
        }

        .slide .lyrics {
            font-size: clamp(1.2rem, 3.5vw, 2rem);
            line-height: 1.7;
            font-weight: 700; /* Changed to bold */
            white-space: pre-line;
            opacity: 0.95;
        }

        /* Controls */
        .controls {
            position: fixed;
            bottom: 30px;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            gap: 15px;
            z-index: 100;
            opacity: 0.4;
            transition: opacity 0.3s ease;
            width: 100%;
            max-width: 400px;
            padding: 0 20px;
            justify-content: center;
        }

        .controls:hover {
            opacity: 1;
        }

        .control-btn {
            background-color: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.3);
            color: #fff;
            padding: 15px 25px;
            cursor: pointer;
            border-radius: 30px;
            font-size: clamp(14px, 2.5vw, 16px);
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
            min-width: 100px;
            min-height: 44px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700; /* Changed to bold */
        }

        .control-btn:hover {
            background-color: rgba(255, 255, 255, 0.2);
            transform: translateY(-2px);
        }

        .control-btn:active {
            transform: translateY(0);
        }

        /* Info Bar */
        .info-bar {
            position: fixed;
            top: 20px;
            left: 0;
            right: 0;
            display: flex;
            justify-content: space-between;
            padding: 0 20px;
            z-index: 50;
        }

        .song-title {
            font-size: clamp(1rem, 2.5vw, 1.2rem);
            opacity: 0.7;
            font-weight: 700; /* Changed to bold */
            max-width: 70%;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

        .slide-counter {
            background-color: rgba(255, 255, 255, 0.1);
            padding: 6px 15px;
            border-radius: 20px;
            font-size: clamp(12px, 2vw, 14px);
            backdrop-filter: blur(10px);
            font-weight: 700; /* Changed to bold */
        }

        .back-btn {
            position: fixed;
            top: 20px;
            left: 20px;
            background-color: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.3);
            color: #fff;
            padding: 10px 18px;
            cursor: pointer;
            border-radius: 25px;
            font-size: clamp(12px, 2vw, 14px);
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
            z-index: 101;
            min-height: 40px;
            display: flex;
            align-items: center;
            font-weight: 700; /* Changed to bold */
        }

        .back-btn:hover {
            background-color: rgba(255, 255, 255, 0.2);
        }

        /* Help Text */
        .help-text {
            position: fixed;
            bottom: 100px;
            left: 50%;
            transform: translateX(-50%);
            font-size: clamp(12px, 2vw, 14px);
            opacity: 0.3;
            text-align: center;
            width: 90%;
            max-width: 400px;
            font-weight: 600; /* Changed to semi-bold */
        }

        /* Add Song Modal */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.8);
            z-index: 1000;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background-color: #111;
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 10px;
            padding: 25px;
            width: 100%;
            max-width: 600px;
            max-height: 80vh;
            overflow-y: auto;
        }

        .modal h2 {
            margin-bottom: 20px;
            font-weight: 700; /* Changed to bold */
            font-size: clamp(1.5rem, 4vw, 2rem);
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-size: clamp(14px, 2.5vw, 16px);
            opacity: 0.8;
            font-weight: 700; /* Changed to bold */
        }

        .form-group input,
        .form-group textarea {
            width: 100%;
            background-color: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: #fff;
            padding: 12px;
            border-radius: 5px;
            font-size: clamp(14px, 2.5vw, 16px);
            font-family: 'Arial', sans-serif;
            min-height: 44px;
            font-weight: 700; /* Changed to bold */
        }

        .form-group textarea {
            height: 100px;
            resize: vertical;
        }

        .slides-container {
            margin-top: 20px;
        }

        .slide-input {
            background-color: rgba(255, 255, 255, 0.03);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 5px;
            padding: 15px;
            margin-bottom: 15px;
        }

        .slide-input h4 {
            margin-bottom: 10px;
            font-weight: 700; /* Changed to bold */
            opacity: 0.8;
            font-size: clamp(16px, 3vw, 18px);
        }

        .remove-slide {
            background: rgba(255, 0, 0, 0.2);
            border: 1px solid rgba(255, 0, 0, 0.4);
            color: #fff;
            padding: 6px 12px;
            border-radius: 5px;
            cursor: pointer;
            font-size: clamp(12px, 2vw, 14px);
            float: right;
            min-height: 36px;
            font-weight: 700; /* Changed to bold */
        }

        .remove-slide:hover {
            background: rgba(255, 0, 0, 0.3);
        }

        .modal-buttons {
            display: flex;
            gap: 10px;
            margin-top: 20px;
        }

        .modal-buttons button {
            flex: 1;
            padding: 14px;
            background-color: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.3);
            color: #fff;
            cursor: pointer;
            border-radius: 5px;
            transition: all 0.3s ease;
            font-size: clamp(14px, 2.5vw, 16px);
            min-height: 44px;
            font-weight: 700; /* Changed to bold */
        }

        .modal-buttons button:hover {
            background-color: rgba(255, 255, 255, 0.2);
        }

        .modal-buttons .primary {
            background-color: rgba(0, 255, 0, 0.2);
            border-color: rgba(0, 255, 0, 0.4);
        }

        .modal-buttons .primary:hover {
            background-color: rgba(0, 255, 0, 0.3);
        }

        /* Fullscreen button */
        .fullscreen-btn {
            position: fixed;
            top: 20px;
            right: 20px;
            background-color: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.3);
            color: #fff;
            padding: 10px;
            cursor: pointer;
            border-radius: 25px;
            font-size: clamp(14px, 2vw, 16px);
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
            z-index: 101;
            min-width: 40px;
            min-height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700; /* Changed to bold */
        }

        .fullscreen-btn:hover {
            background-color: rgba(255, 255, 255, 0.2);
        }

        /* Loading indicator */
        .loading {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: #000;
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 2000;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s ease;
        }

        .loading.active {
            opacity: 1;
            pointer-events: all;
        }

        .loading-spinner {
            width: 40px;
            height: 40px;
            border: 3px solid rgba(255, 255, 255, 0.1);
            border-radius: 50%;
            border-top-color: #fff;
            animation: spin 1s ease-in-out infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Responsive adjustments */
        @media (max-width: 480px) {
            .controls {
                bottom: 20px;
                gap: 10px;
            }
            
            .control-btn {
                padding: 12px 18px;
                min-width: 80px;
            }
            
            .song-list {
                grid-template-columns: 1fr;
                max-height: 50vh;
            }
            
            .modal-content {
                padding: 20px;
            }
        }

        /* Landscape mobile adjustments */
        @media (max-height: 500px) and (orientation: landscape) {
            .menu-title {
                margin-bottom: 10px;
            }
            
            .song-list {
                max-height: 40vh;
            }
            
            .controls {
                bottom: 10px;
            }
            
            .help-text {
                bottom: 70px;
            }
        }
    </style>
</head>
<body>
    <!-- Loading indicator -->
    <div class="loading" id="loading">
        <div class="loading-spinner"></div>
    </div>

    <!-- Song Selection Menu -->
    <div class="menu-container" id="menuContainer">
        <h1 class="menu-title">Select a Song</h1>
        <div class="song-list" id="songList">
            <!-- Song buttons will be generated here -->
        </div>
        <button class="add-song-btn" onclick="openAddSongModal()">
            <div class="add-icon">+</div>
            <div>Add New Song</div>
        </button>
    </div>

    <!-- Presentation Container -->
    <div class="presentation-container" id="presentationContainer">
        <button class="back-btn" onclick="backToMenu()">← Back</button>
        <button class="fullscreen-btn" id="fullscreenBtn" onclick="toggleFullscreen()">⛶</button>
        
        <div class="info-bar">
            <div class="song-title" id="currentSongTitle"></div>
            <div class="slide-counter">
                <span id="currentSlide">1</span> / <span id="totalSlides">1</span>
            </div>
        </div>

        <div class="slide-container" id="slideContainer">
            <!-- Slides will be dynamically inserted here -->
        </div>

        <div class="controls">
            <button class="control-btn" onclick="previousSlide()">← Previous</button>
            <button class="control-btn" onclick="nextSlide()">Next →</button>
        </div>

        <div class="help-text">
            Use arrow keys, space bar, or swipe to navigate
        </div>
    </div>

    <!-- Add Song Modal -->
    <div class="modal" id="addSongModal">
        <div class="modal-content">
            <h2>Add New Song</h2>
            <form id="addSongForm">
                <div class="form-group">
                    <label for="songTitle">Song Title</label>
                    <input type="text" id="songTitle" required>
                </div>
                <div class="form-group">
                    <label for="songAuthor">Author</label>
                    <input type="text" id="songAuthor" required>
                </div>
                
                <div class="slides-container">
                    <h3>Slides</h3>
                    <div id="slidesList">
                        <!-- Slide inputs will be added here -->
                    </div>
                    <button type="button" onclick="addSlideInput()" style="background: rgba(0,255,0,0.1); border: 1px dashed rgba(0,255,0,0.3); color: #fff; padding: 12px; border-radius: 5px; cursor: pointer; width: 100%; margin-top: 10px; min-height: 44px; font-weight: 700;">
                        + Add Slide
                    </button>
                </div>
                
                <div class="modal-buttons">
                    <button type="button" onclick="closeAddSongModal()">Cancel</button>
                    <button type="submit" class="primary">Save Song</button>
                </div>
            </form>
        </div>
    </div>

    <script>
        // Song database - now loaded from localStorage or defaults
        let songs = [
            {
                title: "Amazing Grace",
                author: "John Newton",
                slides: [
                    {
                        title: "Verse 1",
                        lyrics: "Amazing grace, how sweet the sound\nThat saved a wretch like me\nI once was lost, but now am found\nWas blind, but now I see"
                    },
                    {
                        title: "Verse 2",
                        lyrics: "'Twas grace that taught my heart to fear\nAnd grace my fears relieved\nHow precious did that grace appear\nThe hour I first believed"
                    },
                    {
                        title: "Verse 3",
                        lyrics: "Through many dangers, toils and snares\nI have already come\n'Tis grace has brought me safe thus far\nAnd grace will lead me home"
                    },
                    {
                        title: "Verse 4",
                        lyrics: "When we've been there ten thousand years\nBright shining as the sun\nWe've no less days to sing God's praise\nThan when we've first begun"
                    }
                ]
            },
            {
                title: "How Great Thou Art",
                author: "Carl Boberg",
                slides: [
                    {
                        title: "Verse 1",
                        lyrics: "O Lord my God, when I in awesome wonder\nConsider all the works Thy hands have made\nI see the stars, I hear the rolling thunder\nThy power throughout the universe displayed"
                    },
                    {
                        title: "Chorus",
                        lyrics: "Then sings my soul, my Savior God, to Thee\nHow great Thou art, how great Thou art\nThen sings my soul, my Savior God, to Thee\nHow great Thou art, how great Thou art"
                    },
                    {
                        title: "Verse 2",
                        lyrics: "When through the woods and forest glades I wander\nAnd hear the birds sing sweetly in the trees\nWhen I look down from lofty mountain grandeur\nAnd hear the brook and feel the gentle breeze"
                    }
                ]
            },
            {
                title: "Blessed Assurance",
                author: "Fanny Crosby",
                slides: [
                    {
                        title: "Verse 1",
                        lyrics: "Blessed assurance, Jesus is mine\nO what a foretaste of glory divine\nHeir of salvation, purchase of God\nBorn of His Spirit, washed in His blood"
                    },
                    {
                        title: "Chorus",
                        lyrics: "This is my story, this is my song\nPraising my Savior all the day long\nThis is my story, this is my song\nPraising my Savior all the day long"
                    },
                    {
                        title: "Verse 2",
                        lyrics: "Perfect submission, all is at rest\nI in my Savior am happy and blessed\nWatching and waiting, looking above\nFilled with His goodness, lost in His love"
                    }
                ]
            },
            {
                title: "It Is Well",
                author: "Horatio Spafford",
                slides: [
                    {
                        title: "Verse 1",
                        lyrics: "When peace like a river, attendeth my way\nWhen sorrows like sea billows roll\nWhatever my lot, thou hast taught me to say\nIt is well, it is well, with my soul"
                    },
                    {
                        title: "Chorus",
                        lyrics: "It is well\nWith my soul\nIt is well, it is well, with my soul"
                    },
                    {
                        title: "Verse 2",
                        lyrics: "Though Satan should buffet, though trials should come\nLet this blest assurance control\nThat Christ has regarded my helpless estate\nAnd hath shed His own blood for my soul"
                    }
                ]
            }
        ];

        let currentSong = null;
        let currentSlideIndex = 0;
        let slideInputCount = 0;
        let touchStartX = 0;
        let touchEndX = 0;

        // Load songs from localStorage
        function loadSongs() {
            showLoading();
            try {
                const savedSongs = localStorage.getItem('lyricsPresenterSongs');
                if (savedSongs) {
                    songs = JSON.parse(savedSongs);
                }
            } catch (e) {
                console.error('Error loading songs:', e);
            }
            hideLoading();
        }

        // Save songs to localStorage
        function saveSongs() {
            try {
                localStorage.setItem('lyricsPresenterSongs', JSON.stringify(songs));
            } catch (e) {
                console.error('Error saving songs:', e);
                alert('Could not save songs. Storage might be full.');
            }
        }

        // Loading indicator
        function showLoading() {
            document.getElementById('loading').classList.add('active');
        }

        function hideLoading() {
            setTimeout(() => {
                document.getElementById('loading').classList.remove('active');
            }, 300);
        }

        // Initialize
        function init() {
            loadSongs();
            renderSongMenu();
            setupTouchEvents();
            setupVolumeButtons();
        }

        // Setup touch events for swipe navigation
        function setupTouchEvents() {
            const slideContainer = document.getElementById('slideContainer');
            
            slideContainer.addEventListener('touchstart', e => {
                touchStartX = e.changedTouches[0].screenX;
            }, { passive: true });
            
            slideContainer.addEventListener('touchend', e => {
                touchEndX = e.changedTouches[0].screenX;
                handleSwipe();
            }, { passive: true });
        }

        // Handle swipe gesture
        function handleSwipe() {
            if (touchEndX < touchStartX - 50) {
                // Swipe left - next slide
                nextSlide();
            }
            
            if (touchEndX > touchStartX + 50) {
                // Swipe right - previous slide
                previousSlide();
            }
        }

        // Setup volume buttons for navigation (mobile devices)
        function setupVolumeButtons() {
            if ('addEventListener' in document) {
                document.addEventListener('keydown', function(e) {
                    // Only in presentation mode
                    if (!currentSong) return;
                    
                    // Volume up for next slide
                    if (e.key === 'VolumeUp' || e.key === 'AudioVolumeUp') {
                        e.preventDefault();
                        nextSlide();
                    }
                    
                    // Volume down for previous slide
                    if (e.key === 'VolumeDown' || e.key === 'AudioVolumeDown') {
                        e.preventDefault();
                        previousSlide();
                    }
                });
            }
        }

        // Render song selection menu
        function renderSongMenu() {
            const songList = document.getElementById('songList');
            songList.innerHTML = '';
            
            songs.forEach((song, index) => {
                const button = document.createElement('div');
                button.className = 'song-button';
                button.innerHTML = `
                    <div class="song-name">${song.title}</div>
                    <div class="song-info">${song.author} • ${song.slides.length} slides</div>
                    <button class="delete-btn" onclick="deleteSong(${index})" title="Delete song">×</button>
                `;
                button.onclick = (e) => {
                    if (!e.target.classList.contains('delete-btn')) {
                        startPresentation(index);
                    }
                };
                songList.appendChild(button);
            });
        }

        // Delete a song
        function deleteSong(index) {
            if (confirm(`Are you sure you want to delete "${songs[index].title}"?`)) {
                songs.splice(index, 1);
                saveSongs();
                renderSongMenu();
            }
        }

        // Start presentation for selected song
        function startPresentation(songIndex) {
            currentSong = songs[songIndex];
            currentSlideIndex = 0;
            
            document.getElementById('menuContainer').style.display = 'none';
            document.getElementById('presentationContainer').classList.add('active');
            
            document.getElementById('currentSongTitle').textContent = currentSong.title;
            
            renderSlides();
            showSlide(0);
        }

        // Render all slides for current song
        function renderSlides() {
            const container = document.getElementById('slideContainer');
            container.innerHTML = '';
            
            currentSong.slides.forEach((slide, index) => {
                const slideElement = document.createElement('div');
                slideElement.className = 'slide';
                slideElement.innerHTML = `
                    <h2>${slide.title}</h2>
                    <div class="lyrics">${slide.lyrics}</div>
                `;
                container.appendChild(slideElement);
            });
            
            updateSlideCounter();
        }

        // Show specific slide
        function showSlide(index) {
            const slideElements = document.querySelectorAll('.slide');
            slideElements.forEach((slide, i) => {
                slide.classList.toggle('active', i === index);
            });
            currentSlideIndex = index;
            updateSlideCounter();
        }

        // Navigate to next slide
        function nextSlide() {
            if (currentSlideIndex < currentSong.slides.length - 1) {
                showSlide(currentSlideIndex + 1);
            }
        }

        // Navigate to previous slide
        function previousSlide() {
            if (currentSlideIndex > 0) {
                showSlide(currentSlideIndex - 1);
            }
        }

        // Update slide counter
        function updateSlideCounter() {
            document.getElementById('currentSlide').textContent = currentSlideIndex + 1;
            document.getElementById('totalSlides').textContent = currentSong.slides.length;
        }

        // Back to menu
        function backToMenu() {
            document.getElementById('presentationContainer').classList.remove('active');
            document.getElementById('menuContainer').style.display = 'flex';
            currentSong = null;
            
            // Exit fullscreen if in fullscreen mode
            if (document.fullscreenElement) {
                document.exitFullscreen();
            }
        }

        // Toggle fullscreen
        function toggleFullscreen() {
            if (!document.fullscreenElement) {
                document.documentElement.requestFullscreen().catch(err => {
                    console.error(`Error attempting to enable fullscreen: ${err.message}`);
                });
            } else {
                document.exitFullscreen();
            }
        }

        // Modal functions
        function openAddSongModal() {
            document.getElementById('addSongModal').classList.add('active');
            document.getElementById('songTitle').value = '';
            document.getElementById('songAuthor').value = '';
            document.getElementById('slidesList').innerHTML = '';
            slideInputCount = 0;
            addSlideInput(); // Add first slide input
        }

        function closeAddSongModal() {
            document.getElementById('addSongModal').classList.remove('active');
        }

        function addSlideInput() {
            slideInputCount++;
            const slidesList = document.getElementById('slidesList');
            const slideDiv = document.createElement('div');
            slideDiv.className = 'slide-input';
            slideDiv.innerHTML = `
                <h4>Slide ${slideInputCount} <button type="button" class="remove-slide" onclick="removeSlideInput(this)">Remove</button></h4>
                <div class="form-group">
                    <label>Slide Title (e.g., Verse 1, Chorus)</label>
                    <input type="text" class="slide-title" required>
                </div>
                <div class="form-group">
                    <label>Lyrics (use \\n for line breaks)</label>
                    <textarea class="slide-lyrics" required></textarea>
                </div>
            `;
            slidesList.appendChild(slideDiv);
        }

        function removeSlideInput(button) {
            button.closest('.slide-input').remove();
        }

        // Handle form submission
        document.getElementById('addSongForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const title = document.getElementById('songTitle').value;
            const author = document.getElementById('songAuthor').value;
            const slideInputs = document.querySelectorAll('.slide-input');
            
            const newSong = {
                title: title,
                author: author,
                slides: []
            };
            
            slideInputs.forEach(input => {
                const slideTitle = input.querySelector('.slide-title').value;
                const slideLyrics = input.querySelector('.slide-lyrics').value;
                
                if (slideTitle && slideLyrics) {
                    newSong.slides.push({
                        title: slideTitle,
                        lyrics: slideLyrics.replace(/\\n/g, '\n')
                    });
                }
            });
            
            if (newSong.slides.length > 0) {
                songs.push(newSong);
                saveSongs();
                renderSongMenu();
                closeAddSongModal();
            } else {
                alert('Please add at least one slide with lyrics.');
            }
        });

        // Keyboard navigation
        document.addEventListener('keydown', (e) => {
            if (!currentSong) return; // Only in presentation mode
            
            switch(e.key) {
                case 'ArrowRight':
                case ' ':
                    e.preventDefault();
                    nextSlide();
                    break;
                case 'ArrowLeft':
                    e.preventDefault();
                    previousSlide();
                    break;
                case 'Escape':
                    backToMenu();
                    break;
                case 'f':
                case 'F':
                    toggleFullscreen();
                    break;
            }
        });

        // Initialize the app
        document.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>
